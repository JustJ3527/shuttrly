<!-- Public Profile Section - Full access for public profiles or private profiles with access -->
<div class="profile-section public-profile">
    <!-- Profile Header with Banner -->
    <div class="profile-header">
        <!-- Banner Background -->
        <div class="profile-banner">
            {% if profile_user.banner %}
                <img src="{{ profile_user.banner.url }}" alt="Profile banner" class="banner-img">
            {% else %}
                <div class="banner-placeholder"></div>
            {% endif %}
        </div>
        
        <div class="profile-content">
            <div class="profile-avatar">
                {% if profile_user.profile_picture %}
                    <img src="{{ profile_user.profile_picture.url }}" 
                         alt="{{ profile_user.username }}'s profile picture" 
                         class="avatar-img">
                {% else %}
                    <div class="avatar-placeholder">
                        <i class="fas fa-user"></i>
                    </div>
                {% endif %}
            </div>
            
            <div class="profile-info">
                <div class="profile-name-section">
                    <h1 class="profile-name">
                        {% if profile_user.first_name and profile_user.last_name %}
                            {{ profile_user.first_name }} {{ profile_user.last_name }}
                        {% else %}
                            {{ profile_user.username }}
                        {% endif %}
                    </h1>
                    <p class="profile-username">@{{ profile_user.username }}</p>
                    
                    <!-- Online Status -->
                    <div class="online-status">
                        {% if profile_user.is_online %}
                            <span class="status-indicator online">
                                <i class="fas fa-circle"></i> Online
                            </span>
                        {% else %}
                            <span class="status-indicator offline">
                                <i class="fas fa-circle"></i> Offline
                            </span>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Bio Section - Only show if exists -->
                {% if profile_user.bio %}
                <div class="profile-bio">
                    <p>{{ profile_user.bio }}</p>
                </div>
                {% endif %}
                
                <!-- Social Stats - Real information -->
                <div class="social-stats" id="social-stats-{{ profile_user.username }}">
                    <div class="stat-item">
                        <span class="stat-number" id="followers-count-{{ profile_user.username }}">
                            {{ profile_user.get_followers.count }}
                        </span>
                        <span class="stat-label">Followers</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="following-count-{{ profile_user.username }}">
                            {{ profile_user.get_following.count }}
                        </span>
                        <span class="stat-label">Following</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{ profile_user.get_posts_count }}</span>
                        <span class="stat-label">Posts</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">{{ profile_user.get_photos_count }}</span>
                        <span class="stat-label">Photos</span>
                    </div>
                </div>
                
                <!-- Social Actions -->
                <div class="social-actions">
                    <button class="btn btn-follow btn-social follow-btn" 
                            data-username="{{ profile_user.username }}"
                            onclick="handleFollow('{{ profile_user.username }}')">
                        <i class="fas fa-user-plus"></i> Follow
                    </button>
                    
                    <button class="btn btn-close-friend btn-social close-friend-btn" 
                            data-username="{{ profile_user.username }}"
                            onclick="handleCloseFriend('{{ profile_user.username }}')"
                            style="display: none;">
                        <i class="fas fa-heart"></i> Add to Close Friends
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Additional Info Cards -->
    <div class="info-cards">
        <!-- Privacy Status Card -->
        <div class="info-card">
            <div class="card-header">
                <i class="fas fa-lock"></i>
                <h3>Privacy Status</h3>
            </div>
            <div class="card-content">
                <div class="privacy-status">
                    <span class="status-badge {% if profile_user.is_private %}private{% else %}public{% endif %}">
                        {% if profile_user.is_private %}
                            <i class="fas fa-lock"></i> Private Account
                        {% else %}
                            <i class="fas fa-globe"></i> Public Account
                        {% endif %}
                    </span>
                    <p class="privacy-description">
                        {% if profile_user.is_private %}
                            This is a private account. You can see their profile because you're following them.
                        {% else %}
                            This is a public account. Anyone can view their profile and posts.
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Photography Stats Card -->
        {% if profile_user.get_photos_count > 0 %}
        <div class="info-card">
            <div class="card-header">
                <i class="fas fa-camera"></i>
                <h3>Photography Stats</h3>
            </div>
            <div class="card-content">
                <div class="info-item">
                    <i class="fas fa-heart"></i>
                    <span>{{ profile_user.get_likes_received_count }} total likes received</span>
                </div>
                {% if profile_user.get_cameras_used %}
                <div class="info-item">
                    <i class="fas fa-camera-retro"></i>
                    <span>{{ profile_user.get_cameras_count }} camera{{ profile_user.get_cameras_count|pluralize }}: {{ profile_user.get_cameras_used|join:", " }}</span>
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}
        
        <!-- Account Info Card - Less prominent -->
        <div class="info-card" style="opacity: 0.7;">
            <div class="card-header">
                <i class="fas fa-info-circle"></i>
                <h3>Account Details</h3>
            </div>
            <div class="card-content">
                <div class="info-item">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Member since {{ profile_user.date_joined|date:"F Y" }}</span>
                </div>
                {% if profile_user.last_login_date %}
                    <div class="info-item">
                        <i class="fas fa-clock"></i>
                        <span>Last seen {{ profile_user.last_login_date|date:"F j, Y" }}</span>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Posts Section -->
    <div class="posts-section">
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-images"></i> Posts
            </h3>
            <p class="section-subtitle">
                {% if profile_user.get_posts_count > 0 %}
                    {{ profile_user.get_posts_count }} post{{ profile_user.get_posts_count|pluralize }}
                {% else %}
                    Coming soon - Photo sharing functionality
                {% endif %}
            </p>
        </div>
        <div class="posts-grid">
            {% if user_posts %}
                {% for post in user_posts %}
                    <div class="post-card">
                        <a href="{% url 'posts:post_detail' post.id %}" class="post-link">
                            <div class="post-image-container">
                                {% if post.post_type == 'single_photo' and post.content_object %}
                                    <img src="{{ post.content_object.original_file.url }}" 
                                         alt="{{ post.title|default:post.description|truncatechars:50 }}" 
                                         class="post-image">
                                {% elif post.post_type == 'multiple_photos' and post.photos.count > 0 %}
                                    {% if post.photos.count == 2 %}
                                        <div class="two-photos-grid">
                                            {% for photo in post.photos.all|slice:":2" %}
                                                <img src="{{ photo.original_file.url }}" 
                                                     alt="{{ post.title|default:post.description|truncatechars:50 }}" 
                                                     class="post-image">
                                            {% endfor %}
                                        </div>
                                    {% elif post.photos.count > 2 %}
                                        <div class="multiple-photos-grid">
                                            <img src="{{ post.photos.first.original_file.url }}" 
                                                 alt="{{ post.title|default:post.description|truncatechars:50 }}" 
                                                 class="post-image main-image">
                                            <div class="additional-photos">
                                                {% for photo in post.photos.all|slice:"1:3" %}
                                                    <img src="{{ photo.original_file.url }}" 
                                                         alt="{{ post.title|default:post.description|truncatechars:50 }}" 
                                                         class="post-image">
                                                {% endfor %}
                                                {% if post.photos.count > 3 %}
                                                    <div class="more-photos-overlay">
                                                        <span class="more-count">+{{ post.photos.count|add:"-2" }}</span>
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    {% endif %}
                                {% elif post.post_type == 'collection' and post.content_object %}
                                    <img src="{{ post.content_object.cover_photo.image.url }}" 
                                         alt="{{ post.title|default:post.content_object.name }}" 
                                         class="post-image">
                                    <div class="collection-overlay">
                                        <div class="collection-name">{{ post.content_object.name }}</div>
                                        <div class="photo-count">{{ post.content_object.photos.count }} photo{{ post.content_object.photos.count|pluralize }}</div>
                                    </div>
                                {% else %}
                                    <div class="post-placeholder">
                                        <i class="fas fa-image"></i>
                                        <span>No image</span>
                                    </div>
                                {% endif %}
                                
                                <!-- Post info overlay on hover -->
                                <div class="post-info-overlay">
                                    <div class="post-stats">
                                        <div class="stat">
                                            <i class="fas fa-heart"></i>
                                            <span>{{ post.likes_count }}</span>
                                        </div>
                                        <div class="stat">
                                            <i class="fas fa-comment"></i>
                                            <span>{{ post.comments_count }}</span>
                                        </div>
                                        <div class="stat">
                                            <i class="fas fa-eye"></i>
                                            <span>{{ post.views_count }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                {% endfor %}
            {% elif profile_user.get_posts_count > 0 %}
                <!-- Posts exist but user can't see them -->
                <div class="post-placeholder">
                    <i class="fas fa-lock"></i>
                    <span>Posts are private</span>
                </div>
            {% else %}
                <div class="post-placeholder">
                    <i class="fas fa-images"></i>
                    <span>No posts yet</span>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- CSRF Token for AJAX requests -->
{% csrf_token %}
